import numpy as np
from math import log
import operator
from collections import Counter
def get_data():
    # 特征矩阵
    feat_matrix=np.array([
        ['1',0.30839318,0.043522555],
['1',0.095487,0.03808116],
['1',0.11200761,0.04439067],
['1',0.16502143,0.085365],
['1',0.09162857,0.06841837],
['1',0.1293754,0.05915318],
['1',0.07479366,0.054345615],
['1',0.16891336,0.07717483],
['1',0.20733699,0.09177975],
['1',0.18098405,0.07982918],
['1',0.13720745,0.06652644],
['1',0.1216736,0.057648387],
['1',0.06426371,0.026043545],
['1',0.09509494,0.03998376],
['1',0.09235187,0.03685672],
['1',0.10396897,0.039269116],
['1',0.0800803,0.028539276],
['1',0.1988066,0.043859757],
['1',0.10326802,0.08088339],
['1',0.1626442,0.05328548],
['1',0.22157437,0.0901094],
['1',0.2740566,0.17302424],
['1',0.28031752,0.17165597],
['1',0.20145647,0.05570615],
['1',0.22683857,0.11397113],
['1',0.20287277,0.09940397],
['1',0.19058904,0.1064519],
['1',0.11964729,0.07698202],
['1',0.10540085,0.06639199],
['1',0.109649256,0.066321135],
['1',0.122607335,0.058869448],
['1',0.10697297,0.07284589],
['1',0.11762249,0.058796443],
['1',0.09787811,0.046276856],
['1',0.12587456,0.057415295],
['1',0.08566956,0.036088187],
['1',0.10355078,0.04417103],
['1',0.098075725,0.039957255],
['1',0.10851402,0.040850125],
['1',0.49871138,0.034317344],
['1',0.119405076,0.037965253],
['1',0.10006648,0.034653004],
['1',0.09775023,0.02889763],
['1',0.237362,0.40167263],
['1',0.39553884,0.18707839],
['1',0.29594076,0.121074215],
['1',0.27941442,0.12933032],
['1',0.5653825,0.8794678],
['1',0.3580468,0.08544771],
['1',0.12104528,0.07349823],
['1',0.106820926,0.05614355],
['1',0.055752806,0.029220495],
['1',0.05498871,0.021774404],
['1',0.056889776,0.020052493],
['1',0.048855335,0.023475926],
['1',0.06329857,0.023291241],
['1',0.05464041,0.0274211],
['1',0.04149139,0.012147517],
['1',0.0688617,0.026708135],
['1',0.08364045,0.027567951],
['1',0.08011196,0.025966104],
['1',0.08298131,0.019972157],
['1',0.08375075,0.022840591],
['1',0.09163229,0.022911943],
['1',0.08086773,0.023969045],
['1',0.15422936,0.033843845],
['1',0.115847774,0.41467485],
['1',0.11781803,0.037784107],
['1',0.11517602,0.041341364],
['1',0.17862694,0.073261574],
['1',0.09066784,0.09219606],
['1',0.1908295,0.07528255],
['1',0.12271369,0.07337919],
['1',0.11428054,0.03878041],
['1',0.11464149,0.04738234],
['1',0.09431945,0.04801902],
['1',0.09151395,0.041989718],
['1',0.11521157,0.04262653],
['1',0.12924668,0.047840726],
['1',0.11617862,0.041383453],
['1',0.07397574,0.041898012],
['1',0.109652504,0.02760544],
['1',0.13149725,0.03880756],
['1',0.11193099,0.025499988],
['1',0.09543815,0.022665096],
['1',0.09373003,0.022476755],
['1',0.09102661,0.02139904],
['1',0.100722484,0.39542687],
['1',0.112667345,0.025303993],
['1',0.13728571,0.03626132],
['1',0.13773455,0.050635263],
['1',0.13099712,0.04023689],
['1',0.19065215,0.066691376],
['1',0.22035322,0.08236248],
['1',0.1753928,0.102683045],
['1',0.06728793,0.047380432],
['1',0.11972166,0.05862301],
['1',0.10254192,0.054012924],
['1',0.11183482,0.04996826],
['1',0.094415344,0.046941716],
['1',0.099956766,0.04485281],
['1',0.11316582,0.04001384],
['1',0.12103134,0.044296525],
['1',0.08334471,0.046496607],
['1',0.10708554,0.050704014],
['1',0.09271792,0.030076126],
['1',0.0816504,0.03212107],
['1',0.06569548,0.018441254],
['1',0.059605084,0.012048555],
['1',0.058314025,0.008553895],
['1',0.05919052,0.007369664],
['1',0.055647958,0.007701892],
['1',0.09869901,0.009965072],
['1',0.071908765,0.014800547],
['1',0.09414556,0.025195297],
['1',0.87075144,0.02866737],
['1',0.8945076,0.049150348],
['1',0.04193533,0.083745815],
['1',0.19641735,0.0761624],
['1',0.18148872,0.06583241],
['1',0.070649706,0.047409117],
['1',0.1031045,0.03323707],
['1',0.10259571,0.0324201],
['1',0.07127376,0.030092465],
['1',0.066794224,0.027058186],
['1',0.07742173,0.025123749],
['1',0.062180173,0.028324295],
['1',0.07878968,0.024471033],
['1',0.05278686,0.028409097],
['1',0.06137823,0.01605391],
['1',0.08572152,0.03163631],
['1',0.06745249,0.019252574],
['1',0.064239,0.015521419],
['1',0.060542855,0.009460551],
['1',0.055263907,0.006991142],
['1',0.073412165,0.010991792],
['1',0.058941543,0.010492651],
['1',0.07538073,0.018226353],
['1',0.0961612,0.027909912],
['1',0.10824027,0.03334132],
['1',0.118191786,0.038654312],
['1',0.17662048,0.06584669],
['1',0.1860908,0.07371235],
['1',0.11602117,0.037368044],
['1',0.071409844,0.040778507],
['1',0.09889631,0.034635957],
['1',0.07055151,0.0337883],
['1',0.059674367,0.028186584],
['1',0.07903385,0.026123943],
['1',0.05033892,0.022185279],
['1',0.0743645,0.022326738],
['1',0.062812254,0.016543347],
['1',0.028041612,0.013544561],
['1',0.08328079,0.027218025],
['1',0.093283996,0.03674153],
['1',0.095525905,0.035993602],
['1',0.0790108,0.023610437],
['1',0.074134655,0.020963665],
['1',0.058674686,0.011535049],
['1',0.05941679,0.009171438],
['1',0.053262416,0.010683963],
['1',0.078061365,0.022518596],
['1',0.09034283,0.027888648],
['1',0.1301458,0.04870731],
['1',0.14438422,0.052877262],
['1',0.15113287,0.056497786],
['1',0.2002023,0.08943973],
['1',0.077069886,0.040293973],
['1',0.0685632,0.048150096],
['1',0.102889486,0.03880133],
['1',0.056035105,0.030138312],
['1',0.055610217,0.027647195],
['1',0.0888345,0.031484578],
['1',0.06420773,0.0252303],
['1',0.07447077,0.025573567],
['1',0.0384006,0.024897376],
['1',0.0823209,0.031678963],
['1',0.08406789,0.03168212],
['1',0.0759579,0.39111185],
['1',0.07577997,0.021693796],
['1',0.060774293,0.013580341],
['1',0.060611334,0.010811378],
['1',0.060086023,0.013727015],
['1',0.09696526,0.017811194],
['1',0.083351865,0.025081499],
['1',0.12905589,0.046697456],
['1',0.13174656,0.04678575],
['1',0.14572258,0.066021934],
['1',0.09416468,0.09647019],
['1',0.12274102,0.04972715],
['1',0.13978173,0.05656147],
['1',0.05663055,0.03677333],
['1',0.08948421,0.030620882],
['1',0.046802767,0.024186451],
['1',0.0755435,0.025079712],
['1',0.07463544,0.0245609],
['1',0.10326802,0.023425503],
['1',0.07010105,0.02321662],
['1',0.061496753,0.023015097],
['1',0.03633641,0.020580562],
['1',0.074515745,0.026462717],
['1',0.07012756,0.02169948],
['1',0.06896968,0.016098583],
['1',0.059393924,0.011368845],
['1',0.053805564,0.007149679],
['1',0.05899262,0.0065076],
['1',0.06214607,0.011794694],
['1',0.10351752,0.013880328],
['1',0.702503,0.027880581],
['1',0.10516545,0.03227638],
['1',0.1309707,0.04359318],
['1',0.20577964,0.07538336],
['1',0.1508607,0.056988537],
['1',0.06676522,0.056232028],
['1',0.12725016,0.04380884],
['1',0.076487854,0.043674257],
['1',0.10816191,0.03570443],
['1',0.06296542,0.03043716],
['1',0.06277787,0.3991272],
['1',0.082971275,0.02610647],
['1',0.07248677,0.020882368],
['1',0.046515327,0.02095399],
['1',0.064970866,0.021530874],
['1',0.05428729,0.013138109],
['1',0.08443867,0.031963743],
['1',0.07629379,0.02394412],
['1',0.06470428,0.014172754],
['1',0.06507584,0.01069516],
['1',0.047096238,0.18991771],
['1',0.050915796,0.00163551],
['1',0.057454932,0.009532643],
['1',0.39024395,0.7765504],
['1',0.09564272,0.02569024],
['1',0.13459907,0.04318373],
['1',0.15073319,0.048369516],
['1',0.17692883,0.06745564],
['1',0.047452882,0.07409868],
['1',0.15849525,0.058806065],
['1',0.12799042,0.044733256],
['1',0.07260389,0.032885253],
['1',0.033812147,0.02026575],
['1',0.08300639,0.023528824],
['1',0.046140283,0.019946938],
['1',0.072892204,0.01795171],
['1',0.017882617,0.012356946],
['1',0.06391014,0.016666612],
['1',0.0594058,0.014657473],
['1',0.032937147,0.011568416],
['1',0.07297866,0.026274841],
['1',0.06874128,0.020284753],
['1',0.06693681,0.015233506],
['1',0.059311464,0.009114976],
['1',0.04999772,0.003860043],
['1',0.060958557,0.005477035],
['1',0.063916065,0.012617555],
['1',0.058901202,0.010013881],
['1',0.09047642,0.023896258],
['1',0.9548529,0.027510764],
['1',1.0,0.040363654],
['1',0.03328379,0.069238394],
['1',0.18639079,0.071439005],
['1',0.13011004,0.05710705],
['1',0.11261659,0.036933422],
['1',0.05863908,0.028326266],
['1',0.054178953,0.022925045],
['1',0.0819084,0.023048226],
['1',0.044690594,0.018638885],
['1',0.065898836,0.016271822],
['1',0.04933257,0.017137684],
['1',0.052103523,0.010861798],
['1',0.6474182,0.017751869],
['1',0.013001494,0.010749403],
['1',0.06704113,0.021424133],
['1',0.0679993,0.01962178],
['1',0.058195554,0.013058621],
['1',0.052278418,0.006613455],
['1',0.05364878,0.004252335],
['1',0.055931788,0.004277891],
['1',0.052481167,0.006420997],
['1',0.05715669,0.00933109],
['1',0.08646996,0.022473637],
['1',0.09679391,0.027446207],
['1',0.09922504,0.028923806],
['1',0.10211772,0.0571527],
['1',0.14196287,0.05100127],
['1',0.1617599,0.06246018],
['1',0.062406875,0.03725498],
['1',0.0888301,0.0294643],
['1',0.05731817,0.026807807],
['1',0.10378645,0.033883862],
['1',0.05471724,0.017765315],
['1',0.039319225,0.010806682],
['1',0.058962375,0.017817887],
['1',0.056557544,0.015686171],
['1',0.055058535,0.012089767],
['1',0.047888,0.006895902],
['1',0.051159848,0.005020025],
['1',0.06100967,0.008082004],
['1',0.07280918,0.00947257],
['1',0.059487496,0.010894024],
['1',0.075421125,0.018278692],
['1',0.06900677,0.015824],
['1',0.0956145,0.02802498],
['1',0.15424313,0.055635255],
['1',0.16084146,0.062428195],
['1',0.078597926,0.048426643],
['1',0.085802875,0.026012333],
['1',0.07166951,0.03075486],
['1',0.05569181,0.016427167],
['1',0.052187324,0.022269737],
['1',0.08506028,0.026944704],
['1',0.06607502,0.017839683],
['1',0.05282488,0.013406482],
['1',0.033942346,0.018549979],
['1',0.041350894,0.010143678],
['1',0.060309645,0.016129686],
['1',0.052093893,0.011553222],
['1',0.052700534,0.011861112],
['1',0.058519974,0.014255133],
['1',0.04327062,0.007692046],
['1',0.11270309,0.021913774],
['1',0.06285317,0.03389792],
['1',0.18594427,0.0783163],
['1',0.14969385,0.062874],
['1',0.070449874,0.05215503],
['1',0.10557333,0.037174057],
['1',0.087486796,0.046161365],
['1',0.060187973,0.028433958],
['1',0.07160494,0.024809184],
['1',0.051012114,0.023559678],
['1',0.055564933,0.014761988],
['1',0.04244989,0.020159118],
['1',0.05305429,0.0143574],
['1',0.025175016,0.00339452],
['1',0.12233356,0.05713888],
['1',0.08699376,0.03267708],
['1',0.058874864,0.014331131],
['1',0.04550894,0.007062266],
['1',0.04472173,0.004224334],
['1',0.054844704,0.006886938],
['1',0.05485212,0.011910723],
['1',0.062091112,0.015301297],
['1',0.082569815,0.025643613],
['1',0.07979586,0.023278465],
['1',0.10898353,0.037616298],
['1',0.16271795,0.07383475],
['1',0.14220661,0.060146134],
['1',0.13983162,0.06729909],
['1',0.07253604,0.02234132],
['1',0.061423186,0.036105637],
['1',0.060174733,0.028146196],
['1',0.0462212,0.020803515],
['1',0.05613539,0.015094528],
['1',0.047673695,0.010826314],
['1',0.052084576,0.009627971],
['1',0.05361444,0.010841184],
['1',0.043824553,0.005507789],
['1',0.04642254,0.007503487],
['1',0.10799587,0.03286743],
['1',0.06916519,0.015676115],
['1',0.07628408,0.018300625],
['1',0.0529857,0.006264159],
['1',0.044991955,0.001347964],
['1',0.05538723,0.007881604],
['1',0.06682679,0.007152544],
['1',0.0625402,0.008553275],
['1',0.098767176,0.025795214],
['1',0.11779066,0.033663064],
['1',0.14316797,0.047035325],
['1',0.18648626,0.06895951],
['1',0.20284553,0.07299468],
['1',0.07420295,0.0625539],
['1',0.12209818,0.03863047],
['1',0.06496923,0.03154042],
['1',0.05628162,0.025168637],
['1',0.06402381,0.014438928],
['1',0.045052625,0.015362386],
['1',0.029245423,0.008503763],
['1',0.03897867,0.003982756],
['1',0.048550006,0.008705542],
['1',0.03154122,0.00795107],
['1',0.034692157,0.002439356],
['1',0.052494746,0.014753036],
['1',0.06333009,0.016930658],
['1',0.050214764,0.008219919],
['1',0.066731274,0.01361993],
['1',0.039688855,0.0],
['1',0.05804527,0.004584113],
['1',0.053424224,0.007701888],
['1',0.06445155,0.012921993],
['1',0.38733876,0.45796913],
['1',0.12388397,0.04015409],
['1',0.14766096,0.051561],
['1',0.15633194,0.056690857],
['1',0.160045,0.05861335],
['1',0.16160347,0.059277132],
['1',0.01926268,0.023729576],
['1',0.10476395,0.032373395],
['1',0.05305741,0.022050984],
['1',0.049940363,0.017593265],
['1',0.068218805,0.017524924],
['1',0.048598204,0.007977707],
['1',0.037531335,0.010779306],
['1',0.031856425,0.002660972],
['1',0.03759893,0.003509975],
['1',0.063446626,0.016281638],
['1',0.05565557,0.01103112],
['1',0.05111395,0.005029408],
['1',0.05263624,0.002019274],
['1',0.056272216,0.006716904],
['1',0.069585554,0.013754825],
['1',0.07914574,0.017611958],
['1',0.0843553,0.019667353],
['1',0.07600839,0.03558119],
['1',0.17944114,0.06289391],
['1',0.1728744,0.065223],
['1',0.084021375,0.05186531],
['1',0.098364435,0.026537288],
['1',0.06810555,0.029317467],
['1',0.06626975,0.016639998],
['1',0.048377957,0.018360095],
['1',0.067609765,0.016527101],
['1',0.021139136,0.013498203],
['1',0.06680483,0.016954804],
['1',0.041242305,0.013049648],
['1',0.03860769,0.004242724],
['1',0.03712174,0.00326146],
['1',0.062791936,0.01927688],
['1',0.059066974,0.014201396],
['1',0.060225707,0.013239501],
['1',0.052330673,0.00708272],
['1',0.043128986,0.001408497],
['1',0.044366263,0.003641471],
['1',0.12882262,0.019371975],
['1',0.06013711,0.010438117],
['1',0.10332622,0.03082069],
['1',0.0,0.031527363],
['1',0.17559098,0.05731184],
['1',0.20117308,0.09486838],
['1',0.11850522,0.040361326],
['1',0.15249598,0.05528004],
['1',0.05801659,0.034776893],
['1',0.057706755,0.024635753],
['1',0.066916876,0.016160272],
['1',0.04375515,0.021812266],
['1',0.059354767,0.014900979],
['1',0.04241132,0.017604524],
['1',0.04582998,0.02096332],
['1',0.03310232,0.013607201],
['1',0.043431494,0.011684882],
['1',0.025008626,0.011446837],
['1',0.05165014,0.019662356],
['1',0.05032693,0.018054487],
['1',0.6875286,0.011660503],
['1',0.046142876,0.010683272],
['1',0.043344036,0.006362832],
['1',0.051750466,0.009893719],
['1',0.046258066,0.011549748],
['1',0.06994379,0.023185633],
['1',0.11662486,0.043557767],
['1',0.12844795,0.05153821],
['1',0.18257076,0.07755903],
['1',0.18793292,0.08472408],
['1',0.03770426,0.07165556],
['1',0.14300492,0.07397511],
['1',0.025669152,0.044850364],
['1',0.07715967,0.047194052],
['1',0.06566311,0.02994527],
['1',0.05094696,0.038208216],
['1',0.08802285,0.035567954],
['1',0.047577903,0.02934144],
['1',0.053555492,0.036675517],
['1',0.047555618,0.033042073],
['1',0.034396406,0.027846329],
['1',0.03986465,0.031091545],
['1',0.060770042,0.037862014],
['1',0.05329454,0.034511343],
['1',0.0630982,0.036647025],
['1',0.037186287,0.0165485],
['1',0.050077524,0.020655902],
['1',0.052027855,0.021905763],
['1',0.056498915,0.027317738],
['1',0.06103341,0.026736338],
['1',0.09353258,0.034992274],
['1',0.047035456,0.025770564],
['1',0.11056238,0.07047058],
['1',0.12999691,0.08152938],
['1',0.120797396,0.077121496],
['1',0.10744373,0.066880174],
['1',0.062183503,0.054029305],
['1',0.066984855,0.039266977],
['1',0.043156758,0.023071714],
['1',0.049295425,0.027569773],
['1',0.046313625,0.02507925],
['1',0.029358437,0.021831127],
['1',0.038944174,0.39726064],
['1',0.024008034,0.012627289],
['1',0.06091925,0.0354193],
['1',0.053983036,0.02816954],
['1',0.050739586,0.022418337],
['1',0.046279855,0.017667772],
['1',0.9534535,0.346254],
['1',0.056758896,0.020835817],
['1',0.05222495,0.02290918],
['1',0.07879106,0.03908333],
['1',0.06968373,0.033503585],
['1',0.108404934,0.0575559],
['1',0.10323652,0.07664668],
['1',0.17355578,0.10637867],
['1',0.11349548,0.06302848],
['1',0.07395445,0.055512175],
['1',0.047882754,0.038639154],
['1',0.06718177,0.03399728],
['1',0.025570037,0.02379284],
['1',0.053019598,0.025497265],
['1',0.6762643,0.031435642],
['1',0.03628134,0.021782855],
['1',0.043618567,0.02124613],
['1',0.036911976,0.019105744],
['1',0.053398915,0.02758917],
['1',0.049300887,0.025162185],
['1',0.04584425,0.016629491],
['1',0.044315375,0.013761174],
['1',0.08840456,0.024884516],
['1',0.09490363,0.047159415],
['1',0.08988012,0.04479417],
['1',0.11179269,0.05700927],
['1',0.16827081,0.093099914],
['1',0.013627104,0.049815614],
['1',0.12423893,0.074772395],
['1',0.066824794,0.054091945],
['1',0.08889677,0.048045404],
['1',0.055689808,0.03702185],
['1',0.05715431,0.035983294],
['1',0.046035353,0.027711062],
['1',0.05022776,0.024136806],
['1',0.037623588,0.022705348],
['1',0.031191414,0.027385248],
['1',0.060331892,0.034034688],
['1',0.05265325,0.028894402],
['1',0.039838657,0.015571063],
['1',0.0384079,0.011262776],
['1',0.044254817,0.011821865],
['1',0.0463967,0.017804284],
['1',0.08564069,0.021524273],
['1',0.074130446,0.033536024],
['1',0.105110936,0.050626848],
['1',0.18278338,0.09020635],
['1',0.087573886,0.11786042],
['1',0.124772504,0.06493523],
['1',0.12856321,0.06614708],
['1',0.0917067,0.064069875],
['1',0.059812203,0.026019096],
['1',0.05010197,0.035053354],
['1',0.058412828,0.03545151],
['1',0.05301336,0.023784893],
['1',0.04573475,0.03331092],
['1',0.077604145,0.041098025],
['1',0.038168382,0.022927703],
['1',0.002960043,0.012752688],
['1',0.07139913,0.043190498],
['1',0.077380225,0.042243704],
['1',0.055882365,0.029597372],
['1',0.03884415,0.013691283],
['1',0.04787879,0.016819607],
['1',0.054626573,0.01964746],
['1',0.063319296,0.030155763],
['1',0.07239937,0.025953801],
['1',0.09918298,0.051312815],
['1',0.09827614,0.05038293],
['1',0.1591323,0.088986486],
['1',0.17093703,0.09456892],
['1',0.16931187,0.09320492],
['1',0.074870154,0.0464999],
['1',0.06124098,0.053893518],
['1',0.087790176,0.043523967],
['1',0.04608273,0.02842718],
['1',0.06866545,0.03307759],
['1',0.060843196,0.028361019],
['1',0.0655315,0.034298234],
['1',0.08635651,0.025124338],
['1',0.10794924,0.040859874],
['1',0.07681172,0.028613416],
['1',0.5106369,0.03895287],
['1',0.0635239,0.033834983],
['1',0.09416599,0.05419327],
['1',0.060177542,0.02548936],
['1',0.041753504,0.009946905],
['1',0.062672615,0.021989133],
['1',0.07292386,0.024550918],
['1',0.73346364,0.02539093],
['1',0.08306117,0.037976738],
['1',0.10801327,0.05368852],
['1',0.12270449,0.062188152],
['1',0.15582556,0.08318999],
['1',0.07106332,0.087151594],
['1',0.1287042,0.06830145],
['1',0.0629071,0.042783562],
['1',0.10088154,0.051490158],
['1',0.05253129,0.035336923],
['1',0.057638075,0.025315573],
['1',0.17482582,0.11960561],
['1',0.040985554,0.029301517],
['1',0.056326896,0.026683124],
['1',0.03878868,0.03066433],
['1',0.051516905,0.025244836],
['1',0.047006235,0.039563503],
['1',0.06392895,0.03717553],
['1',0.07874319,0.046689387],
['1',0.053262234,0.02324563],
['1',0.063358255,0.028468795],
['1',0.05808182,0.023989653],
['1',0.06442561,0.023798343],
['1',0.09921017,0.031389624],
['1',0.08631548,0.043984096],
['1',0.09855929,0.05226702],
['1',0.13882823,0.07833441],
['1',0.14144777,0.08006182],
['1',0.06484347,0.08983348],
['1',0.12684561,0.07330399],
['1',0.095742844,0.056078997],
['1',0.046772983,0.034488328],
['1',0.07781937,0.03843589],
['1',0.09716258,0.024030844],
['1',0.047482435,0.02766944],
['1',0.047991954,0.024010053],
['1',0.027428558,0.027357245],
['1',0.04566028,0.023244215],
['1',0.051285647,0.04336037],
['1',0.068728834,0.04313562],
['1',0.066073745,0.03722832],
['1',0.06944706,0.05570615],
['1',0.053977244,0.026702102],
['1',0.056603972,0.025865763],
['1',0.05632129,0.02903108],
['1',0.070875645,0.03833794],
['1',0.07770006,0.042563234],
['1',0.08014808,0.043282203],
['1',0.1162264,0.07081371],
['1',0.32603166,0.51423615],
['1',0.119841345,0.08472937],
['1',0.054092906,0.058297962],
['1',0.07337908,0.04303515],
['1',0.04829435,0.03586539],
['1',0.037528478,0.030485472],
['1',0.05546054,0.03188655],
['1',0.016154341,0.021273702],
['1',0.050766516,0.031461842],
['1',0.031821355,0.030591674],
['1',0.038177956,0.021360092],
['1',0.055706497,0.033980228],
['1',0.060763553,0.039527748],
['1',0.051928625,0.031138599],
['1',0.051641908,0.028250417],
['1',0.055953763,0.02997268],
['1',0.059111428,0.02591075],
['1',0.054355938,0.029420342],
['1',0.05932452,0.032657173],
['1',0.06850247,0.039668616],
['1',0.066287674,0.037248082],
['1',0.09463788,0.057377093],
['1',0.10977375,0.06794378],
['1',0.11727567,0.07942947],
['1',0.20093969,0.12789658],
['1',0.08739849,0.059329446],
['1',0.05204596,0.05408518],
['1',0.07194622,0.045409825],
['1',0.04795089,0.041620016],
['1',0.048532225,0.03542511],
['1',0.044488408,0.025358986],
['1',0.044243053,0.0328459],
['1',0.050882723,0.030732438],
['1',0.04520859,0.026694579],
['1',0.013003087,0.024558159],
['1',0.050765548,0.030846026],
['1',0.055533346,0.035199985],
['1',0.054581147,0.027997468],
['1',0.05201417,0.026420696],
['1',0.055707175,0.026786193],
['1',0.052897096,0.023463968],
['1',0.05156224,0.020745168],
['1',0.065699,0.025694232],
['1',0.05628076,0.027440904],
['1',0.06932882,0.035916023],
['1',0.084039986,0.045954257],
['1',0.10315193,0.058221485],
['1',0.10740224,0.060180653],
['1',0.10390251,0.057933923],
['1',0.05510958,0.050938815],
['1',0.07744646,0.042433776],
['1',0.04349662,0.031855952],
['1',0.053584035,0.029621514],
['1',0.051059403,0.033929147],
['1',0.04652831,0.024427531],
['1',0.043095663,0.0291428],
['1',0.049054567,0.026948672],
['1',0.020509383,0.023771709],
['1',0.042800892,0.023183092],
['1',0.05280111,0.028721854],
['1',0.0556634,0.030042173],
['1',0.05788636,0.027763736],
['1',0.046573654,0.019442512],
['1',0.051899023,0.021228336],
['1',0.057112187,0.02049852],
['1',0.06228459,0.029825866],
['1',0.0627402,0.030006057],
['1',0.094241396,0.050162617],
['1',0.09487489,0.05070501],
['1',0.108194426,0.058825217],
['1',0.1756101,0.10350507],
['1',0.10031076,0.061105773],
['1',0.07651906,0.052225307],
['1',0.05829613,0.043640845],
['1',0.050792616,0.03685774],
['1',0.056165773,0.03206769],
['1',0.05043059,0.0334037],
['1',0.038824435,0.030328307],
['1',0.06250188,0.03507772],
['1',0.024744816,0.02907488],
['1',0.0573441,0.032353498],
['1',0.04456552,0.025695622],
['1',0.052391097,0.02907221],
['1',0.052343532,0.029214038],
['1',0.066167936,0.034762967],
['1',0.05080758,0.021429794],
['1',0.04852287,0.01950892],
['1',0.054781683,0.019731276],
['1',0.0461151,0.01992419],
['1',0.0913276,0.024372367],
['1',0.067577206,0.03277867],
['1',0.10058929,0.05428584],
['1',0.1253654,0.06962755],
['1',0.15688063,0.08819349],
['1',0.042071685,0.06786456],
['1',0.09694668,0.07194603],
['1',0.08034581,0.05422829],
['1',0.059376054,0.0444135],
['1',0.06189011,0.032892164],
['1',0.07829981,0.044442575],
['1',0.05005862,0.03847254],
['1',0.054538537,0.036738526],
['1',0.047107503,0.02519485],
['1',0.06701393,0.04276158],
['1',0.0477876,0.024961486],
['1',0.060555283,0.031105882],
['1',0.058428198,0.02636796],
['1',0.055030823,0.024216251],
['1',0.0556199,0.021604406],
['1',0.074235685,0.027644815],
['1',0.07017369,0.035520557],
['1',0.08986176,0.047757328],
['1',0.123086244,0.06926671],
['1',0.11079334,0.06055916],
['1',0.13096325,0.07688662],
['1',0.083481714,0.087692186],
['1',0.06758869,0.052642263],
['1',0.124917425,0.07358722],
['1',0.07620219,0.051682077],
['1',0.037285276,0.036019076],
['1',0.06691242,0.037610162],
['1',0.05635307,0.041565284],
['1',0.026583912,0.032124203],
['1',0.05412827,0.04142888],
['1',0.06111551,0.0351114],
['1',0.05211942,0.03465394],
['1',0.043717705,0.04162075],
['1',0.06508144,0.03154986],
['1',0.16174646,0.029666902],
['1',0.092362,0.008072171],
['1',0.10560306,0.011991362],
['1',0.14934331,0.014081788],
['1',0.14903714,0.02518138],
['1',0.19982442,0.047849253],
['1',0.21435714,0.04577449],
['1',0.37556002,0.09988511],
['1',0.29633665,0.10076231],
['1',0.17998286,0.13585159],
['1',0.2711363,0.10693249],
['1',0.20345286,0.064304866],
['1',0.1740008,0.051643126],
['1',0.10326802,0.028909704],
['1',0.096370205,0.03250924],
['1',0.124615915,0.025983136],
['1',0.12237692,0.028720707],
['1',0.07117322,0.020384276],
['1',0.083165005,0.00964194],
['1',0.09314743,0.017188653],
['1',0.15520722,0.044015203],
['1',0.14129333,0.040253557],
['1',0.14497197,0.030871581],
['1',0.11455121,0.017238459],
['1',0.10676855,0.014035665],
['1',0.11769654,0.019617587],
['1',0.14377053,0.029281337],
['1',0.17596316,0.037822787],
['1',0.80427194,0.04990929],
['1',0.29504654,0.08699514],
['1',0.35383454,0.08950895],
['1',0.5381276,0.32944965],
['1',0.28931403,0.15878724],
['1',0.14789122,0.091561764],
['1',0.1658488,0.052344754],
['1',0.20400193,0.05579506],
['1',0.09526386,0.031897537],
['1',0.12160319,0.024823938],
['1',0.1091632,0.018876763],
['1',0.085788935,0.01615591],
['1',0.062401343,0.03518629],
['1',0.050081905,0.031291794],
['1',0.07021637,0.045454904],
['1',0.06356744,0.038481496],
['1',0.071755394,0.04103992],
['1',0.056123696,0.02816935],
['1',0.057192788,0.027366934],
['1',0.06553122,0.028847888],
['1',0.07157648,0.039172843],
['1',0.0754254,0.04131777],
['1',0.093187034,0.053216685],
['1',0.117856115,0.06929398],
['1',0.14796719,0.08888752],
['1',0.1725141,0.10862137],
['1',0.144893,0.09000188],
['1',0.14607868,0.09271008],
['1',0.05881996,0.063996345],
['1',0.08619005,0.05042661],
['1',0.5742674,0.8160103],
['1',0.060524277,0.04708559],
['1',0.058856394,0.046407018],
['1',0.06456082,0.037291244],
['1',0.07316997,0.04339485],
['1',0.051440462,0.039430857],
['1',0.04824247,0.025465963],
['1',0.057594832,0.034077592],
['1',0.06617381,0.037462104],
['1',0.08131744,0.04486828],
['1',0.061748628,0.028037436],
['1',0.06385326,0.027886277],
['1',0.06144041,0.030411849],
['1',0.08827978,0.034982488],
['1',0.0813177,0.042601086],
['1',0.10464618,0.057279047],
['1',0.12565939,0.07010056],
['1',0.13905509,0.07925129],
['1',0.13523693,0.07837992],
['1',0.076875106,0.06642924],
['1',0.062560156,0.054857813],
['1',0.08506979,0.0494277],
['1',0.057275776,0.042810958],
['1',0.055989552,0.042309973],
['1',0.071897544,0.041974746],
['1',0.04735431,0.05570615],
['1',0.0578549,0.032586295],
['1',0.03918469,0.030974329],
['1',0.055277716,0.03135154],
['1',0.047148544,0.02617746],
['1',0.06463226,0.03961938],
['1',0.066878065,0.03841761],
['1',0.07114253,0.03748202],
['1',0.06666163,0.033221364],
['1',0.06338213,0.02969908],
['1',0.07808903,0.03389616],
['1',0.07475581,0.03950778],
['1',0.09701023,0.054790273],
['1',0.11001551,0.062031105],
['1',0.14594567,0.086915195],
['1',0.14582081,0.08742319],
['1',0.14444338,0.08701728],
['1',0.13786899,0.07933637],
['1',0.033668883,0.07011387],
['1',0.0878036,0.07271138],
['1',0.104187794,0.06063804],
['1',0.04444674,0.04262314],
['1',0.09153774,0.06036437],
['1',0.05603643,0.043851066],
['1',0.07526817,0.04777037],
['1',0.052787162,0.042650826],
['1',0.0634898,0.038516566],
['1',0.05457392,0.042289276],
['1',0.051593296,0.030988699],
['1',0.07143536,0.044972055],
['1',0.06483639,0.03721676],
['1',0.05621357,0.03224152],
['1',0.05430825,0.024775384],
['1',0.057887875,0.025299476],
['1',0.060200512,0.031962737],
['1',0.09873081,0.040307682],
['1',0.10007898,0.05308847],
['1',0.104476124,0.066402145],
['1',0.14472255,0.08524734],
['1',0.171186,0.10037746],
['1',0.050981805,0.08219523],
['1',0.121796705,0.073022544],
['1',0.13157669,0.07770949],
['1',0.072552465,0.06579278],
['1',0.06468282,0.054281794],
['1',0.0678549,0.04787036],
['1',0.07253247,0.04257759],
['1',0.05469866,0.044932064],
['1',0.05150997,0.037410636],
['1',0.05274673,0.03251762],
['1',0.04389505,0.024525193],
['1',0.044687558,0.024147106],
['1',0.07650764,0.04743674],
['1',0.07401971,0.04457461],
['1',0.058465984,0.026945084],
['1',0.05083509,0.022953546],
['1',0.056846227,0.023905925],
['1',0.054456983,0.026603691],
['1',0.09605755,0.03924814],
['1',0.081020735,0.043007847],
['1',0.118234634,0.06679308],
['1',0.12457119,0.071311764],
['1',0.1184623,0.068717316],
['1',0.12161694,0.06921258],
['1',0.055552606,0.071812235],
['1',0.11047289,0.067660116],
['1',0.031466085,0.042376354],
['1',0.087781176,0.04968285],
['1',0.06714224,0.048727065],
['1',0.06517098,0.04897872],
['1',0.08387406,0.051135182],
['1',0.09946509,0.061998717],
['1',0.0793494,0.06596182],
['1',0.08196768,0.05292631],
['1',0.075219356,0.04901761],
['1',0.068789974,0.03926216],
['1',0.07099031,0.037377667],
['1',0.06720243,0.030434962],
['1',0.0702897,0.031843573],
['1',0.07362448,0.038876507],
['1',0.07945667,0.04272773],
['1',0.08932636,0.04958698],
['1',0.11689558,0.06728598],
['1',0.11812678,0.080755815],
['1',0.13343665,0.077367134],
['1',0.13755216,0.081289254],
['1',0.107002124,0.06311596],
['1',0.06357893,0.06808287],
['1',0.07040963,0.06728774],
['1',0.0824765,0.0665758],
['1',0.80307585,1.0],
['1',0.10046417,0.058847874],
['1',0.07515384,0.04140447],
['1',0.07560936,0.042529877],
['1',0.06006718,0.036106538],
['1',0.067947514,0.038225222],
['1',0.06691216,0.036979437],
['1',0.08632968,0.05130142],
['1',0.073796146,0.03919016],
['1',0.06997787,0.03756729],
['1',0.07066468,0.034989238],
['1',0.07085233,0.033613242],
['1',0.07184655,0.03712949],
['1',0.09811111,0.04015207],
['1',0.085461184,0.04442916],
['1',0.118840985,0.06460949]

])
    
       
    values_size = feat_matrix.shape[0]
    for discretefeat_idx in range(1):  # 6个离散特征
        dict_value_encode = {}
        encode = 0
        for value in feat_matrix[:,discretefeat_idx]:
            if value not in dict_value_encode.keys():
                encode += 1
                dict_value_encode[value] = encode
        for value_idx in range(values_size):
            feat_matrix[value_idx][discretefeat_idx] = dict_value_encode[feat_matrix[value_idx][discretefeat_idx]]
    feat_matrix = feat_matrix.astype(np.float64)
    # 类别标签
    labels=np.array(['true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'true',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',
'false',

])
    # 特征名
    feat_names = np.array(['序号', 'cpc', 'cpm'])
    return feat_matrix,labels,feat_names

# 计算经验熵
def cal_entropy(x):
    x_set = set(x)
    x_size = x.shape[0]
    entropy = 0.0
    for label in x_set:
        p = np.count_nonzero(x == label) / x_size
        entropy -= p * log(p,2)
    return entropy

# 根据选定特征计算条件信息熵
def cal_conditionalentropy(feat_values,labels):
    values_set = set(feat_values)
    values_size = feat_values.shape[0]
    c_entropy = 0.0
    for value in values_set:
        p = np.count_nonzero(feat_values == value)/values_size
        c_entropy += p * cal_entropy(labels[feat_values == value])
    return c_entropy

# 计算连续特征的最小条件熵，以得到最大的信息增益
'''
设某连续特征有n个取值，先将它们从小到大排序
使用二分法，尝试n-1种中间值(函数中的阈值就是中间值，通过前后两个元素的平均数计算得)
比较各自的条件熵，取最小的那个，最终得到最大的信息增益
返回值有二，一是最小的条件熵，二是中间值
'''
def cal_min_conditionalentropy(feat_values,labels):
    values_size = feat_values.shape[0]
    zip_feat_values_labels = dict(zip(feat_values,labels)) # 将连续特征取值和对应的分类标签zip起来
    # 按照特征值升序排序,分类标签跟着一起排
    zip_feat_values_labels_sorted = dict(sorted(zip_feat_values_labels.items(),key=operator.itemgetter(0)))
    feat_values_sorted = np.array(list(zip_feat_values_labels_sorted.keys())) # 排序过后的特征取值
    labels_sorted = np.array(list(zip_feat_values_labels_sorted.values()))  # 排序过后的分类标签
    thresholds = [(feat_values_sorted[idx]+feat_values_sorted[idx+1])/2  # n个特征取值有n-1个缝隙,得n-1个阈值
                  for idx in range(feat_values_sorted.shape[0]-1)]
    min_c_entropy = float('inf')
    min_c_entropy_threshold = (feat_values_sorted[0] + feat_values_sorted[1])/2 # 初始化阈值是第一个缝隙中的
    for threshold in thresholds:
        filter_left = feat_values_sorted <= threshold  # 阈值左边的部分
        feat_values_left = feat_values_sorted[filter_left]
        labels_left = labels_sorted[filter_left]

        filter_right = feat_values_sorted > threshold  # 阈值右边的部分
        feat_values_right = feat_values_sorted[filter_right]
        labels_right = labels_sorted[filter_right]
        c_entropy = feat_values_left.shape[0]/values_size*cal_entropy(labels_left) +\
                    feat_values_right.shape[0]/values_size*cal_entropy(labels_right)
        if c_entropy <= min_c_entropy:
            min_c_entropy = c_entropy
            min_c_entropy_threshold = threshold
    return min_c_entropy,min_c_entropy_threshold  # 返回有二,最小的条件信息熵和对应的阈值

# 根据选定特征计算信息增益
def cal_info_gain(feat_values,labels):
    # 如果是离散值
    if feat_values[0].item()>=1:
        return cal_entropy(labels) - cal_conditionalentropy(feat_values,labels),'discrete'
    # 如果是连续的
    else:
        min_c_entropy, min_c_entropy_threshold = cal_min_conditionalentropy(feat_values,labels)
        return cal_entropy(labels) - min_c_entropy,min_c_entropy_threshold


# 根据选定特征计算信息增益比
def cal_info_gain_ratio(feat_values,labels):
    return (cal_info_gain(feat_values,labels) + 0.01)/(cal_entropy(feat_values)+0.01)


# 生成决策树中的第二个终止条件满足时,返回实例数最大的类
def get_max_label(labels):
    return Counter(labels)[0][0]

# 选择信息增益、信息增益比最大的特征
def get_best_feat(feat_matrix,labels):
    feat_num = feat_matrix.shape[1]
    best_feat_idx = -1
    max_info_gain = 0.0
    ret_sign = 'discrete'  # 默认是离散的
    for feat_idx in range(feat_num):
        feat_values = feat_matrix[:,feat_idx]
        info_gain,sign = cal_info_gain(feat_values,labels)
        if info_gain >= max_info_gain:
            max_info_gain = info_gain
            best_feat_idx = feat_idx
            ret_sign = sign
    return best_feat_idx,ret_sign

# 根据选定特征,划分得到子集
def get_subset(feat_matrix,labels,best_feat,sign):
    feat_values = feat_matrix[:,best_feat]
    if sign == 'discrete':
        values_set = set(feat_values)
        feat_matrix = np.delete(feat_matrix,best_feat,1)
        feat_matrixset = {}
        labelsset = {}
        for value in values_set:
            feat_matrixset[value] = feat_matrix[feat_values==value]
            labelsset[value] = labels[feat_values==value]
    # 连续值
    else:
        threshold = sign
        feat_matrixset = {}
        labelsset = {}
        # 左
        filter_left = feat_values <= threshold
        feat_matrixset['<={}'.format(threshold)] = feat_matrix[filter_left]
        labelsset['<={}'.format(threshold)] = labels[filter_left]
        # 右
        filter_right = feat_values > threshold
        feat_matrixset['>{}'.format(threshold)] = feat_matrix[filter_right]
        labelsset['>{}'.format(threshold)] = labels[filter_right]
    return feat_matrixset,labelsset

"""
introduction:
    生成一棵决策树
parameter:
    feat_matrix:特征矩阵
    labels:类别标签
    feat_names:特征名称
    method:选择方法(信息增益、信息增益比)
"""
def create_decision_tree(feat_matrix,labels,feat_names,method):
    # 首先考虑两种终止条件:1、类别标签只有一种类型 2、特征没有其他取值
    if len(set(labels)) == 1:
        return labels[0] # 类型为numpy.int32
    if feat_matrix.shape[0] == 0:
        return get_max_label(labels)
    # 选择信息增益最大的特征，sign标志着是离散特征还是连续特征，若连续，sign为阈值
    best_feat,sign = get_best_feat(feat_matrix,labels)
    best_feat_name = feat_names[best_feat]
    # 初始化树
    decision_tree = {best_feat_name:{}}
    # 如果是离散的,则要删除该特征，否则不删。思考:连续特征何时删？当
    if sign == 'discrete':
        feat_names = np.delete(feat_names,best_feat)
    # 得到子集(得到字典类型的子集,键为选定特征的不同取值)
    feat_matrixset, labelsset = get_subset(feat_matrix,labels,best_feat,sign)
    # 递归构造子树
    for value in feat_matrixset.keys():
        decision_tree[best_feat_name][value] = create_decision_tree(feat_matrixset[value],labelsset[value],feat_names,method)
    return decision_tree
if __name__ == "__main__":
   feat_matrix,labels,feat_names = get_data()
   decision_tree = create_decision_tree(feat_matrix,labels,feat_names,method='ID3')
   print(decision_tree)
   #createPlot(decision_tree)